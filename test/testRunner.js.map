{"version":3,"sources":["test/testRunner.es6"],"names":[],"mappings":";;AAAA,IAAI,QAAQ,GAAG,OAAO,CAAC,kBAAkB,CAAC;IACtC,MAAM,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;;AAEvC,SAAS,SAAS,CAAC,MAAM,EAAE;AACzB,MAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;AAClD,QAAM,CAAC,OAAO,CAAC,UAAA,KAAK,EAAI;AACtB,QAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AACnD,QAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AAC1C,UAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;AACxD,kBAAc,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AACnC,aAAS,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;AACtC,SAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI,EAAI;AAC1B,UAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC;AACzB,UAAI,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAC7B,UAAI,gBAAgB,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AACpD,UAAI,EAAE,YAAA,CAAC;AACP,UAAI,WAAS,gBAAgB,OAAI,CAAC;AAClC,UAAI,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAClC,UAAI,GAAG,YAAA,CAAC;AACR,gBAAU,CAAC,YAAM;AACf,WAAG,GAAG,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AAC1C,YAAI,CAAC,GAAG,EAAE;AACR,cAAI,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AACxC,aAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;AACrB,cAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAChD,qBAAW,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAC1C,cAAI,CAAC,IAAI,iBAAe,GAAG,CAAC,SAAS,kBAAa,WAAW,CAAC,SAAS,AAAE,CAAC;SAC3E;AACD,sBAAc,CAAC,WAAW,CAAC,gBAAgB,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;OACzD,EAAE,CAAC,CAAC,CAAC;KACP,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ;;AAED,SAAS,gBAAgB,CAAC,IAAI,EAAE,GAAG,EAAE;AACnC,MAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AACtC,MAAI,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AACvC,MAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC;AAClC,IAAE,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;AACrB,MAAI,IAAI,CAAC,IAAI,EAAE;AACb,MAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;GACnD,MAAM;AACL,MAAE,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;GAC1B;AACD,SAAO,EAAE,CAAC;CACX;;;AAGD,SAAS,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE;AAC1B,MAAI,SAAS,GAAG,CAAC,CAAC,UAAU,IAAI,EAAE,CAAC;AACnC,MAAI,SAAS,GAAG,CAAC,CAAC,UAAU,IAAI,EAAE,CAAC;AACnC,MAAI,WAAW,GAAG,CAAC,CAAC,UAAU,IAAI,EAAE,CAAC;AACrC,MAAI,WAAW,GAAG,CAAC,CAAC,UAAU,IAAI,EAAE,CAAC;AACrC,MAAI,aAAa,GAAG,IAAI,CAAC;AACzB,MAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,QAAQ,EAAE;AAC7B,WAAO,KAAK,CAAC;GACd;AACD,MAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,IAAI,EAAE;;AAEzC,WAAO,KAAK,CAAC;GACd;AACD,MAAI,AAAC,SAAS,CAAC,MAAM,KAAK,SAAS,CAAC,MAAM,IACrC,WAAW,CAAC,MAAM,KAAK,WAAW,CAAC,MAAM,AAAC,EAAE;AAC/C,WAAO,KAAK,CAAC;GACd;AACD,MAAI,CAAC,YAAY,CAAC,WAAW,EAAE,WAAW,CAAC,EAAE;AAC3C,WAAO,KAAK,CAAC;GACd;;AAED,OAAK,IAAI,CAAC,GAAC,CAAC,EAAE,GAAG,GAAC,SAAS,CAAC,MAAM,EAAE,CAAC,GAAC,GAAG,EAAE,CAAC,EAAE,EAAE;AAC9C,iBAAa,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;GAC1D;AACD,SAAO,aAAa,CAAC;CACtB;;;AAGD,SAAS,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE;AAC1B,MAAI,IAAI,EAAE,QAAQ,CAAC;AACnB,OAAK,IAAI,CAAC,GAAC,CAAC,EAAE,GAAG,GAAC,CAAC,CAAC,MAAM,EAAE,CAAC,GAAC,GAAG,EAAE,CAAC,EAAE,EAAE;AACtC,QAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AACZ,YAAQ,GAAG,IAAI,CAAC,IAAI,CAAC;AACrB,QAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;AACpD,aAAO,KAAK,CAAC;KACd;GACF;AACD,SAAO,IAAI,CAAC;CACb;;AAED,MAAM,CAAC,OAAO,GAAG;AACf,WAAS,EAAE,SAAS;CACrB,CAAC","file":"test/testRunner.es6","sourcesContent":["let compiler = require('../dist/compiler'),\n    parser = require('../dist/parser');\n\nfunction runSuites(suites) {\n  let container = document.querySelector('#output');\n  suites.forEach(suite => {\n    let suiteContainer = document.createElement('div');\n    let header = document.createElement('h2');\n    header.appendChild(document.createTextNode(suite.name));\n    suiteContainer.appendChild(header);\n    container.appendChild(suiteContainer);\n    suite.tests.forEach(test => {\n      let html = test.template;\n      let ast = parser.parse(html);\n      let compiledTemplate = compiler.compile(ast, 'abc');\n      let tl;\n      eval(`tl = ${compiledTemplate};`);\n      let out = tl.render(test.context);\n      let res;\n      setTimeout(() => {\n        res = compareNodes(out, test.expectedDom);\n        if (!res) {\n          let div = document.createElement('div');\n          div.appendChild(out);\n          let expectedDiv = document.createElement('div');\n          expectedDiv.appendChild(test.expectedDom);\n          test.fail = `Expected ${div.innerHTML} to equal ${expectedDiv.innerHTML}`;\n        }\n        suiteContainer.appendChild(createTestOutput(test, res));\n      }, 0);\n    });\n  });\n}\n\nfunction createTestOutput(test, res) {\n  let li = document.createElement('li');\n  let desc = document.createElement('p');\n  desc.innerHTML = test.description;\n  li.appendChild(desc);\n  if (test.fail) {\n    li.appendChild(document.createTextNode(test.fail))\n  } else {\n    li.classList.add('pass');\n  }\n  return li;\n}\n\n// Compare DOM nodes for equality\nfunction compareNodes(a, b) {\n  let aChildren = a.childNodes || [];\n  let bChildren = b.childNodes || [];\n  let aAttributes = a.attributes || [];\n  let bAttributes = b.attributes || [];\n  let childrenMatch = true;\n  if (a.nodeType !== b.nodeType) {\n    return false;\n  }\n  if (a.nodeType === 3 && a.data !== b.data) {\n    // Compare text node values\n    return false;\n  }\n  if ((aChildren.length !== bChildren.length) ||\n      (aAttributes.length !== bAttributes.length)) {\n    return false;\n  }\n  if (!compareAttrs(aAttributes, bAttributes)) {\n    return false;\n  }\n\n  for (var i=0, len=aChildren.length; i<len; i++) {\n    childrenMatch = compareNodes(aChildren[i], bChildren[i]);\n  }\n  return childrenMatch;\n}\n\n// Compare the attributes of two nodes for equality\nfunction compareAttrs(a, b) {\n  var attr, attrName;\n  for (var i=0, len=a.length; i<len; i++) {\n    attr = a[0];\n    attrName = attr.name;\n    if (!b[attrName] || b[attrName].value !== attr.value) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = {\n  runSuites: runSuites\n};\n"]}